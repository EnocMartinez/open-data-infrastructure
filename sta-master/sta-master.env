#==============================================================================#
#                      SensorThings API Service (Master)                       #
#------------------------------------------------------------------------------#
# This file configures the SensorThings API (FROST-Server implementatino) and  #
# its postgresql database. 'Master' means that this is the primary database    #
# where all the write operations should be performed.                          #
#==============================================================================#

# WARNING: Do not edit this file! Modify odi secrets.env file instead!

# CONVENTIONS: For security reasons this file is a "bridge" between the env variables
# in the host machine and the docker containers. Only the required env vars for the
# service are copied (upercase in host secrets.env, lowercase within the containers).

# SensorThings Environment Variables #
sta_db_user=${STA_DB_USER}
sta_db_name=${STA_DB_NAME}
sta_db_password=${STA_DB_PASSWORD}
sta_db_host=sta_db_master  # SensorThings database container name
sta_root_url=https://${ODI_STA_MASTER_DNS}/FROST-Server
sta_db_port=${STA_DB_PORT}

sta_readonly_user=${STA_DB_READONLY_USER}
sta_readonly_password=${STA_DB_READONLY_PASSWORD}

sta_db_replicator=${STA_DB_REPLICATOR}
sta_db_replicator_user=${STA_DB_REPLICATOR_USER}
sta_db_replicator_password=${STA_DB_REPLICATOR_PASSWORD}

# SensorThings API HTTP BasicAuth configuration #
sta_api_read_user=${STA_API_READ_USER}
sta_api_read_password=${STA_API_READ_PASSWORD}
sta_api_write_user=${STA_API_WRITE_USER}
sta_api_write_password=${STA_API_WRITE_PASSWORD}
sta_api_admin_user=${STA_API_ADMIN_USER}
sta_api_admin_password=${STA_API_ADMIN_PASSWORD}


# FROST Server
persistence_db_username=${STA_DB_USER}
persistence_db_password=${STA_DB_PASSWORD}
serviceRootUrl=${sta_root_url}
persistence_db_url="jdbc:postgresql://${sta_db_host}:${STA_DB_PORT}/${STA_DB_NAME}"
maxTop=100000
http_cors_enable=true
http_cors_allowed.origins=*
persistence_db_driver=org.postgresql.Driver
persistence_autoUpdateDatabase=true
maxDataSize=50000000 # default is 25 MB, upgraded to 50
enableMultiDatastream=false
enableActuation=false
bus_workerPoolSize=50   ## max 50 threads
bus_queueSize=10000000  # 10 MB (default is unknown)
mqtt_Enabled=false

# FROST Server BasicAuth
auth_provider=de.fraunhofer.iosb.ilt.frostserver.auth.basic.BasicAuthProvider
auth_db_driver=org.postgresql.Driver
auth_db_url=${persistence_db_url}
auth_db_username=${persistence_db_username}
auth_db_password=${persistence_db_password}
auth_autoUpdateDatabase=true
auth_allowAnonymousRead=${STA_ALLOW_ANONYMOUS_READ}

# PostgresQL
POSTGRES_DB=${STA_POSTGRES_DB}
POSTGRES_USER=${STA_POSTGRES_USER}
POSTGRES_PASSWORD=${STA_POSTGRES_PASSWORD}

